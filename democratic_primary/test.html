<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@jhkforecast">
  <meta name="twitter:creator" content="@jhkersting">
  <meta name="twitter:title" content="Pollster & Forecaster Accurcay - Iowa">
  <meta name="twitter:description" content="Who Best Predicted Iowa?">
  <meta name="twitter:image"
    content="https://jhkforecasts.com/democratic_primary-02.png">
  <title>Pollster & Forecaster Accurcay - Iowa</title>
  <script data-ad-client="ca-pub-8025120308040073" async
    src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-140782021-2"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'UA-140782021-2');
  </script>
  <script data-ad-client="ca-pub-8025120308040073" async
    src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <link rel="icon" href="https://jkstats76.files.wordpress.com/2019/02/cropped-site-icon.png?w=32" sizes="32x32">
  <link rel="icon" href="https://jkstats76.files.wordpress.com/2019/02/cropped-site-icon.png?w=192" sizes="192x192">

  <script src="https://d3js.org/d3.v4.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3-tip/0.7.1/d3-tip.min.js"></script>
  <link rel="stylesheet" href="https://use.typekit.net/htk2wjy.css">
  <link rel="stylesheet" href="index.css">

</head>





<table style="border-collapse: collapse;" cellspacing="0" cellpadding="0" width="100%">
  <tbody>
    <!--Twitter Ratings-->
    <tr style="height: 40px;"></tr>
    <tr>
      <td style="width: 14%;">
        <h1 style="text-align:center;" id="biden-text"></h1>
      </td>
      <td style="width: 14%;">
        <h1 style="text-align:center;" id="bloomberg-text"></h1>
      </td>
    </tr>
    <td style="width: 14%;">
      <input type="range" min="-10" max="10" value="0" class="slider" id="biden-slider">
    </td>
    <td style="width: 14%;">
      <input type="range" min="-10" max="10" value="0" class="slider" id="bloomberg-slider">
    </td>
    </tr>
  </tbody>
</table>

<p id="demo"></p>

</select>
<script>
var numberformat = d3.format(".1f")
  d3.csv("manip.csv",(data) =>{


    console.log(data)
  
  update(+d3.select('#biden-slider').property('value'), +d3.select('#bloomberg-slider').property('value'));

  function update(biden, bloomberg) {
    
    
    var newdata = data.map((d,i)=>{
      return{
        State: d.State,
        Biden:+d.Biden == 0 ?0:+d.Biden  + biden<0?0:+d.Biden  + biden,
        Bloomberg: +d.Bloomberg  == 0 ?0:+d.Bloomberg  + bloomberg<0?0:+d.Bloomberg  + bloomberg,
      }
    })
    


    console.log(newdata)
    var finaldata = []
    for (let j = 0; j < 57; j++) {
        var keystate = newdata[j].State

        var dataraw = newdata.filter(function (d) { return d.State == keystate; })



        
        var final = [dataraw[0].State,numberformat(dataraw[0].Biden),numberformat(dataraw[0].Bloomberg)]

        finaldata.push(final)
    }


   
    document.getElementById("demo").innerHTML = finaldata.join("<br>")
  }


  var biden_slider = d3.select("#biden-slider")
    .on("change", function () {
      update(+this.value, 0);
    })

  var bloomberg_slider = d3.select("#bloomberg-slider")
    .on("change", function () {
      update(0, +this.value);
    })
  })

</script>
</body>
</script>




</body>

</html